{"payload":{"meta":{"Graph":{"@Type":"81297157","@Value":{"Guid":"(Guid)e68d1860-d0ee-489b-b098-d1d3228d5105","ParentGuid":"(Guid)a2e4a053-9bab-4e6d-8bfa-78852b0a11c2","Name":"(string)Calculus","Properties":{"@Type":"2c41fa04:IDictionary","@Value":[{"@Key":"(Guid)97c1f2ea-5995-48b9-abd5-a3ab983c5def","@Value":{"@Type":"97c1f2ea","@Value":{"UseExplicitExecutionOrder":"(bool)False"}}}]},"TypeGuid":"(Guid)6f9dac99-8de1-4efc-8465-68ac443b7d08","EmbeddedTypeGuids":{"@Type":"[Guid]","@Value":["(Guid)a9ed5b7e-75c5-4651-af16-d2c27e98cb94","(Guid)3b83b776-fb25-43b8-99f2-3c507c9143fc"]}}},"TypeInfos":{"2c41fa04":"{2c41fa04-1834-41c1-816e-303c7aa2c05b}","81297157":"{81297157-7ec9-45ce-845e-84cab2b88ade}","97c1f2ea":"{97c1f2ea-5995-48b9-abd5-a3ab983c5def}","bool":"System.Boolean","Guid":"System.Guid","string":"System.String"}},"object":{"Graph":{"@Type":"6f9dac99","@Value":{"SpecialFunc":{"@Type":"0db3d7bb:Enum","@Value":"None"},"Implementation":{"@Type":"3b83b776","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)IF GVL.startUp THEN\n\tstartupReadcsv();\n\tIF NOT GVL.startUp THEN\t\n\t\tGVL.xReadCOP := FALSE;\n\t\tGVL.startdelaytimer :=TRUE;\n\tEND_IF\n\t\nEND_IF\n\nGVL.delaytimer (IN:= GVL.startdelaytimer, PT:=T#5S);\nIF GVL.delaytimer.Q THEN\n\tGVL.xReadCOP := TRUE;\n\tGVL.startdelaytimer:=FALSE;\n\tresetbuttons := TRUE ;\nEND_IF\ndelaytimer2 (IN:= resetbuttons, PT:=T#5S);\nIF delaytimer2.Q THEN\n\tGVL.xReadCOP := FALSE;\n\tGVL.initRead := FALSE;\n\tresetbuttons := FALSE;\nEND_IF\n\n// Get system time\ncurrent_date := TO_UDINT(SysTimeRtcGet(Result_time));\nResult_time := SysTimeRTCConvertUTCToLocal(current_date, udiLocal_DateAndTime);\nGVL.CurrentDate := TO_DT(udiLocal_DateAndTime); // DT#2018-6-6-9:8:38\n\n// MWCC\nTot_Q2_MWh:=Tot_Q2:=Chiller_1.Q2_chillerMWh + sequence.Chiller_2_Q2_MWh + Sequence.Chiller_3_Q2_MWh + Sequence.Chiller_4_Q2_MWh + Sequence.Chiller_5_Q2_MWh + Sequence.Chiller_6_Q2_MWh ;\nTot_P1_MWh:=Tot_Q2:=Chiller_1.Chiller_P1_MWh + sequence.Chiller_2_P1_MWh + Sequence.Chiller_3_P1_MWh + Sequence.Chiller_4_P1_MWh + Sequence.Chiller_5_P1_MWh + Sequence.Chiller_6_P1_MWh ;\n\n\n\n\n// New Func\nPower_motor_1_kW:=sequence.P1_motor_1_kW;\nPower_motor_2_kW:=sequence.P1_motor_2_kW;;\nPower_motor_3_kW:=sequence.P1_motor_3_kW;;\n(*\nPower_motor_4_kW:=Chiller_4.P1_motor_kW;\nPower_motor_5_kW:=Chiller_5.P1_motor_kW;\nPower_motor_6_kW:=Chiller_6.P1_motor_kW;\n*)\n\nTot_Power_motor:=Power_motor_1_kW + Power_motor_2_kW + Power_motor_3_kW + Power_motor_4_kW;\nTot_Q2:=Chiller_1.Chiller_capacity_kW + sequence.Q2kW_chiller_2 + Sequence.Q2kW_chiller_3 + Sequence.Q2kW_chiller_4 + Sequence.Q2kW_chiller_5 + Sequence.Q2kW_chiller_6;\n// Tot_Q2:=Chiller_1.Chiller_capacity_kW + Chiller_2.Chiller_capacity_kW + Chiller_3.Chiller_capacity_kW + Chiller_4.Chiller_capacity_kW ;\nCOP_chiller_1:=Chiller_1.COP_chiller_ele;\nCOP_chiller_2:=Chiller_2.COP_chiller_ele;\nCOP_chiller_3:=Chiller_3.COP_chiller_ele;\nCOP_chiller_4:=Chiller_4.COP_chiller_ele;\n(*\nCOP_chiller_5:=Chiller_5.COP_chiller_ele;\nCOP_chiller_6:=Chiller_6.COP_chiller_ele;\n*)\ntotRunningChillers := BOOL_TO_INT(Chiller_1.Unit_running) + BOOL_TO_INT(Chiller_2.Unit_running) + BOOL_TO_INT(Chiller_3.Unit_running) + BOOL_TO_INT(Chiller_4.Unit_running);\n\nIF Chiller_1.Unit_running THEN\n\tPI_calculation(Chiller_1.Chiller_capacity,Chiller_1.Temp_water_inlet_cond,COP_chiller_1,Chiller_1.Temp_chilled_medium_out, 1, PI_act=>PI_chiller_1, noCalc_error=>PI_Calc_Error_AC1, COP_theo=>COP_theo_AC1);\t\n\tWastedEnergy_AC1 := Wasted_calc(Chiller_1.Chiller_capacity_kW, COP_theo_AC1, Power_motor_1_kW) ;\n\tELSE\n\tPI_chiller_1 := 0;\n\tWastedEnergy_AC1 := 0;\n\tPI_Calc_Error_AC1 := FALSE;\n\tCOP_theo_AC1 := 0;\nEND_IF\n\nIF Chiller_2.Unit_running THEN\n\tPI_calculation(Chiller_2.Chiller_capacity,Chiller_2.Temp_water_inlet_cond,COP_chiller_2,Chiller_2.Temp_chilled_medium_out, 1, PI_act=>PI_chiller_2,noCalc_error=>PI_Calc_Error_AC2, COP_theo=>COP_theo_AC2);\n\tWastedEnergy_AC2 := Wasted_calc(Chiller_2.Chiller_capacity_kW, COP_theo_AC2, Power_motor_2_kW) ;\n\tELSE\n\tPI_chiller_2 := 0;\n\tWastedEnergy_AC2 := 0;\n\tPI_Calc_Error_AC2 := FALSE;\n\tCOP_theo_AC2 := 0;\nEND_IF\n\nIF Chiller_3.Unit_running THEN\n\tPI_calculation(Chiller_3.Chiller_capacity,Chiller_3.Temp_water_inlet_cond,COP_chiller_3,Chiller_3.Temp_chilled_medium_out, 1, PI_act=>PI_chiller_3,noCalc_error=>PI_Calc_Error_AC3, COP_theo=>COP_theo_AC3);\n\tWastedEnergy_AC3 := Wasted_calc(Chiller_3.Chiller_capacity_kW, COP_theo_AC3, Power_motor_3_kW) ;\n\tELSE\n\tPI_chiller_3 := 0;\n\tWastedEnergy_AC3 := 0;\t\n\tPI_Calc_Error_AC3 := FALSE;\n\tCOP_theo_AC3 := 0;\nEND_IF\n\nIF Chiller_4.Unit_running THEN\n\tPI_calculation(Chiller_4.Chiller_capacity,Chiller_4.Temp_water_inlet_cond,COP_chiller_4,Chiller_4.Temp_chilled_medium_out, 1, PI_act=>PI_chiller_4,noCalc_error=>PI_Calc_Error_AC4, COP_theo=>COP_theo_AC4);\n\tWastedEnergy_AC4 := Wasted_calc(Chiller_4.Chiller_capacity_kW, COP_theo_AC4, Power_motor_4_kW) ;\n\tELSE\n\tPI_chiller_4 := 0;\n\tWastedEnergy_AC4 := 0;\n\tPI_Calc_Error_AC4 := FALSE;\n\tCOP_theo_AC4 := 0;\nEND_IF\n\n(*\nIF Chiller_5.Unit_running THEN\n\tPI_calculation(Chiller_5.Chiller_capacity,Chiller_5.Temp_water_inlet_cond,COP_chiller_5,Chiller_5.Temp_chilled_medium_out, 2, PI_act=>PI_chiller_5,noCalc_error=>PI_Calc_Error_AC5, COP_theo=>COP_theo_AC5);\n\tWastedEnergy_AC5 := Wasted_calc(sequence.Q2kW_chiller_5, COP_theo_AC5, Power_motor_5_kW) ;\n\tELSE\n\tPI_chiller_5 := 0;\n\tWastedEnergy_AC5 := 0;\n\tPI_Calc_Error_AC5 := TRUE ;\t\t\t\nEND_IF\n\nIF Chiller_6.Unit_running THEN\n\tPI_calculation(Chiller_6.Chiller_capacity,Chiller_6.Temp_water_inlet_cond,COP_chiller_6,Chiller_6.Temp_chilled_medium_out, 2, PI_act=>PI_chiller_6,noCalc_error=>PI_Calc_Error_AC6, COP_theo=>COP_theo_AC6);\n\tWastedEnergy_AC6 := Wasted_calc(sequence.Q2kW_chiller_6, COP_theo_AC6, Power_motor_6_kW) ;\n\tELSE\n\tPI_chiller_6 := 0;\n\tWastedEnergy_AC6 := 0 ;\n\tPI_Calc_Error_AC6 := TRUE ;\t\t\t\nEND_IF\n*)\n\n\nPI_chiller_1_word := REAL_TO_WORD(PI_chiller_1 * 100) ;\nPI_chiller_2_word := REAL_TO_WORD(PI_chiller_2 * 100) ;\nPI_chiller_3_word := REAL_TO_WORD(PI_chiller_3 * 100) ;\nPI_chiller_4_word := REAL_TO_WORD(PI_chiller_4 * 100) ;\nPI_chiller_5_word := REAL_TO_WORD(PI_chiller_5 * 100) ;\nPI_chiller_6_word := REAL_TO_WORD(PI_chiller_6 * 100) ;\n\nWastedEnergy_AC1_word := REAL_TO_WORD(WastedEnergy_AC1) ;\nWastedEnergy_AC2_word := REAL_TO_WORD(WastedEnergy_AC2) ;\nWastedEnergy_AC3_word := REAL_TO_WORD(WastedEnergy_AC3) ;\nWastedEnergy_AC4_word := REAL_TO_WORD(WastedEnergy_AC4) ;\nWastedEnergy_AC5_word := REAL_TO_WORD(WastedEnergy_AC5) ;\nWastedEnergy_AC6_word := REAL_TO_WORD(WastedEnergy_AC6) ;\n\n\n\n(*\nPI_calculation(95,31,4.5,6.1, 1, PI_act=>PI_chiller_1 ,noCalc_error=>PI_Calc_Error_AC1, COP_theo=>COP_theo_AC1);\nPI_calculation(92,31,4.5,6.1, 3, PI_act=>PI_chiller_2 ,noCalc_error=>PI_Calc_Error_AC2, COP_theo=>COP_theo_AC2);\nPI_calculation(91,31,4.5,6.1, 2, PI_act=>PI_chiller_3 ,noCalc_error=>PI_Calc_Error_AC3, COP_theo=>COP_theo_AC3);\nPI_calculation(90,31,4.5,6.1, 3, PI_act=>PI_chiller_4 ,noCalc_error=>PI_Calc_Error_AC4, COP_theo=>COP_theo_AC4);\n*)\n\nIF totRunningChillers>0 THEN\n\tTotal_PI:=Tot_PI(PI_chiller_1, PI_chiller_2, PI_chiller_3, PI_chiller_4, PI_chiller_5, PI_chiller_6 , totRunningChillers) ;\n\tELSE \n\tTotal_PI := 0 ;\nEND_IF\n\n","LineInfoPersistence":"(string)e68d1860-d0ee-489b-b098-d1d3228d5105_Impl_LineIds"}}}},"Interface":{"@Type":"a9ed5b7e","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)PROGRAM Calculus\nVAR\n\n\n// MWCC\n\nNakW_chiller_3 : REAL ;\nNakW_chiller_4 : REAL ;\n\nCOP_chiller_3 : REAL ;\nCOP_chiller_4 : REAL ;\nNakW_chiller_5 : REAL ;\nNakW_chiller_6 : REAL ;\n\nCOP_chiller_5 : REAL ;\nCOP_chiller_6 : REAL ;\n{attribute 'ac_datalog_hysteresis' := '100'}\n{attribute 'ac_datalog' := 'DatalogChannel_4'}\nTot_Power_motor : REAL ;\n{attribute 'ac_datalog_hysteresis' := '300'}\n{attribute 'ac_datalog' := 'DatalogChannel_4'}\nTot_Q2 : REAL ;\n{attribute 'ac_datalog_hysteresis' := '100'}\n{attribute 'ac_datalog' := 'DatalogChannel_4'}\nTot_Q2_MWh : REAL ;\n{attribute 'ac_datalog_hysteresis' := '100'}\n{attribute 'ac_datalog' := 'DatalogChannel_4'}\nTot_P1_MWh : REAL ;\nPower_motor_3_kW : REAL ;\nPower_motor_4_kW : REAL ;\nPower_motor_5_kW : REAL ;\nPower_motor_6_kW : REAL ;\nPower_3_not_zero : REAL ;\nPower_4_not_zero : REAL ;\nPower_5_not_zero : REAL ;\nPower_6_not_zero : REAL ;\n\n// SE700\nQ2kW_chiller_1 : REAL ;\nQ2kW_chiller_2 : REAL ;\nChiller_1_dpCW_bar : REAL ;\nChiller_2_dpCW_bar : REAL ;\nChiller_1_SR_dpCW_bar : REAL ;\nChiller_2_SR_dpCW_bar : REAL ;\nPower_motor_1_kW : REAL ;\nPower_motor_2_kW : REAL ;\nPower_1_not_zero : REAL ;\nPower_2_not_zero : REAL ;\nNakW_chiller_1 : REAL ;\nNakW_chiller_2 : REAL ;\nCOP_chiller_1 : REAL ;\nCOP_chiller_2 : REAL ;\n\n\n\nPower_3_not_zero_func: WORD := 100;\nPower_4_not_zero_func :  WORD := 100;\nCOP_chiller_3_func :  WORD := 100;\nCOP_chiller_4_func :  WORD := 100;\nPower_5_not_zero_func: WORD := 100;\nPower_6_not_zero_func :  WORD := 100;\nCOP_chiller_5_func :  WORD := 100;\nCOP_chiller_6_func :  WORD := 100;\nTot_Power_motor_func :  WORD := 100;\nTot_Q2_func :  WORD := 100;\nTot_Q2_MWh_func :  WORD := 100;\nTot_Na_MWh_func :  WORD := 100;\nPower_motor_3_kW_func :  WORD := 100;\nPower_motor_4_kW_func :  WORD := 100;\n\n// SE700\n\nMan_Auto_Chiller_1_func :  WORD := 100;\nMan_Auto_Chiller_2_func :  WORD := 100;\n//SE700_Chiller_1_Modb|||VALISERR(LOCAL.MODBUS2.Chiller_1.Program_number);//\n//SE700_Chiller_2_Modb|||VALISERR(LOCAL.MODBUS2.Chiller_2.Program_number);\nFlow_factor_chiller1_func :  WORD := 100;\nFlow_factor_chiller2_func :  WORD := 100;\n\n\nSR_Nom_dP_bar_func :  WORD := 100;\n\n\nChiller_1_dT_func :  WORD := 100;\nChiller_2_dT_func :  WORD := 100;\nChiller_1_max_dT_func :  WORD := 100;\nChiller_2_max_dT_func :  WORD := 100;\nChiller_1_Capacity_func :  WORD := 100;\nChiller_2_Capacity_func :  WORD := 100;\nChiller_1_CapacitykW_func :  WORD := 100;\nChiller_2_CapacitykW_func :  WORD := 100;\nChiller_1_dpCW_bar_func :  WORD := 100;\nChiller_2_dpCW_bar_func :  WORD := 100;\nChiller_1_SR_dpCW_bar_func :  WORD := 100;\nChiller_2_SR_dpCW_bar_func :  WORD := 100;\nPower_motor_1_kW_func :  WORD := 100;\nPower_motor_2_kW_func :  WORD := 100;\nPower_1_not_zero_func :  WORD := 100;\nPower_2_not_zero_func :  WORD := 100;\nCOP_chiller_1_func :  WORD := 100;\nCOP_chiller_2_func :  WORD := 100;\nChiller_1_Capacity_corr_flow_factor_func :  WORD := 100;\nChiller_2_Capacity_corr_flow_factor_func :  WORD := 100;\n// New Variables\nPI_chiller_1  : REAL ;\nPI_chiller_1_word : WORD ;\nPI_Calc_Error_AC1 : BOOL ;\nPI_chiller_2  : REAL ;\nPI_chiller_2_word : WORD ;\nPI_Calc_Error_AC2 : BOOL ;\nPI_chiller_3  : REAL ;\nPI_chiller_3_word : WORD ;\nPI_Calc_Error_AC3 : BOOL ;\nPI_chiller_4  : REAL ;\nPI_chiller_4_word : WORD ;\nPI_Calc_Error_AC4 : BOOL ;\nPI_chiller_5  : REAL ;\nPI_chiller_5_word : WORD ;\nPI_Calc_Error_AC5 : BOOL ;\nPI_chiller_6  : REAL ;\nPI_chiller_6_word : WORD ;\nPI_Calc_Error_AC6 : BOOL ;\ndelaytimer2 : TON ;\t\nresetbuttons : BOOL := FALSE  ;\nCOP_theo_AC1 :REAL ;\t\nCOP_theo_AC2 :REAL ;\nCOP_theo_AC3 :REAL ;\nCOP_theo_AC4 :REAL ;\nCOP_theo_AC5 :REAL ;\nCOP_theo_AC6 :REAL ;\ntotRunningChillers : INT;\nWastedEnergy_AC1 :REAL ;\nWastedEnergy_AC1_word :WORD ;\nWastedEnergy_AC2 :REAL ;\nWastedEnergy_AC2_word :WORD ;\nWastedEnergy_AC3 :REAL ;\nWastedEnergy_AC3_word :WORD ;\nWastedEnergy_AC4 :REAL ;\nWastedEnergy_AC4_word :WORD ;\nWastedEnergy_AC5 :REAL ;\nWastedEnergy_AC5_word :WORD ;\nWastedEnergy_AC6 :REAL ;\nWastedEnergy_AC6_word :WORD ;\nTotal_PI : REAL ;\n// Time variables\nResult_time : SysTimeRtc.RTS_IEC_RESULT;\nudiLocal_DateAndTime : UDINT;\ncurrent_date : UDINT ;\n\n\t\nEND_VAR\n","LineInfoPersistence":"(string)e68d1860-d0ee-489b-b098-d1d3228d5105_Decl_LineIds"}}}},"UniqueIdGenerator":"(string)669","POULevel":{"@Type":"8e575c5b:Enum","@Value":"Standard"},"ChildObjectGuids":{"@Type":"ArrayList:IList","@Value":[]},"AddAttributeSubsequent":"(bool)False"}},"TypeInfos":{"0db3d7bb":"{0db3d7bb-cde0-4416-9a7b-ce49a0124323}","3b83b776":"{3b83b776-fb25-43b8-99f2-3c507c9143fc}","6f9dac99":"{6f9dac99-8de1-4efc-8465-68ac443b7d08}","8e575c5b":"{8e575c5b-1d37-49c6-941b-5c0ec7874787}","a9ed5b7e":"{a9ed5b7e-75c5-4651-af16-d2c27e98cb94}","ArrayList":"System.Collections.ArrayList","bool":"System.Boolean","f3878285":"{f3878285-8e4f-490b-bb1b-9acbb7eb04db}","string":"System.String"}}},"FormatVersion":"1.0"}